@import url("modern-normalize/modern-normalize.css");

/*
 * OKLCH-Based Calculated Color System
 * 
 * This system uses OKLCH color space for perceptually accurate contrast calculations
 * and automatic color derivation. Only base OKLCH values need to be defined - all
 * surface variations, text colors, and interactive states are mathematically derived.
 */
:root {
  --font-sans: "Source Sans 3 Variable", arial, sans-serif;
  --font-serif: "Bitter Variable", georgia, serif;
  --font-mono: "Inconsolata Variable", "Courier New", monospace;

  /*
   * Base OKLCH Color Values
   * OKLCH: L (lightness 0-1), C (chroma 0-0.4+), H (hue 0-360°)
   * 
   * These are the only values that need to be manually defined.
   * All other colors are mathematically derived to ensure:
   * - Perceptually uniform contrast ratios
   * - Gamut-safe color calculations
   * - Consistent visual hierarchy across themes
   */

  /* Active palette - keep others commented for future testing */

  /* https://coolors.co/palette/ff6700-ebebeb-c0c0c0-3a6ea5-004e98 */
  --surface-l: 0.99;
  --surface-c: 0;
  --surface-h: 0;
  --primary-l: 0.44;
  --primary-c: 0.14;
  --primary-h: 254;
  --accent-l: 0.7;
  --accent-c: 0.2;
  --accent-h: 44;

  /* Alternative palettes for testing - keep commented until final selection */

  /* Warm red-blue palette */

  /* https://coolors.co/palette/e63946-f1faee-a8dadc-457b9d-1d3557 */

  /* --surface-l: 0.99;
  --surface-c: 0.01;
  --surface-h: 138;

  --primary-l: 0.55;
  --primary-c: 0.1;
  --primary-h: 238;

  --accent-l: 0.55;
  --accent-c: 0.21;
  --accent-h: 22; */

  /* Cool blue-yellow palette */

  /* --surface-l: 0.99;
--surface-c: 0.01;
--surface-h: 111;

--primary-l: 0.55;
--primary-c: 0.1;
--primary-h: 230;

--accent-l: 0.82;
--accent-c: 0.14;
--accent-h: 89; */

  /* Calculated Surface Colors using OKLCH */

  /*
   * Surface Hierarchy System with Directional Stepping
   * 
   * The surface-sign calculation determines stepping direction based on lightness:
   * - Light themes (surface-l > 0.5): containers get progressively darker
   * - Dark themes (surface-l < 0.5): containers get progressively lighter
   * 
   * This creates consistent visual hierarchy where containers are always
   * distinguishable from the base surface, regardless of theme.
   * 
   * The infinity multiplication creates a step function:
   * - Returns -1 for light surfaces (step darker)
   * - Returns +1 for dark surfaces (step lighter)
   * - Threshold at 0.57 accounts for perceptual lightness differences
   */

  /* Surface color lightness sign: determines stepping direction */
  --surface-sign: clamp(-1, (0.57 - var(--surface-l)) * infinity, 1);

  /* OKLCH-based surface colors */
  --color-surface: oklch(var(--surface-l) var(--surface-c) var(--surface-h));
  --color-surface-container-lowest: oklch(
    calc(var(--surface-l) + 0.015 * var(--surface-sign)) var(--surface-c)
      var(--surface-h)
  );
  --color-surface-container-low: oklch(
    calc(var(--surface-l) + 0.03 * var(--surface-sign)) var(--surface-c)
      var(--surface-h)
  );
  --color-surface-container: oklch(
    calc(var(--surface-l) + 0.045 * var(--surface-sign)) var(--surface-c)
      var(--surface-h)
  );
  --color-surface-container-high: oklch(
    calc(var(--surface-l) + 0.06 * var(--surface-sign)) var(--surface-c)
      var(--surface-h)
  );
  --color-surface-container-highest: oklch(
    calc(var(--surface-l) + 0.075 * var(--surface-sign)) var(--surface-c)
      var(--surface-h)
  );

  /* Calculated Text Colors using OKLCH */

  /*
   * Automatic Text Color Generation with Proportional Desaturation
   * 
   * Text colors are calculated to ensure sufficient contrast while preventing
   * gamut clipping through proportional chroma scaling:
   * 
   * 1. Lightness: Stepped away from surface using surface-sign direction
   * 2. Chroma: Proportionally scaled based on lightness change direction
   * 3. Hue: Inherited from surface to maintain color relationship
   * 
   * The min() function calculates the correct chroma scaling ratio by comparing
   * two possible lightness relationships:
   * - Brightening ratio: new_lightness / base_lightness
   * - Darkening ratio: (1 - new_lightness) / (1 - base_lightness)
   * 
   * One ratio will be >1 (incorrect direction), the other <1 (correct direction).
   * min() automatically selects the correct scaling ratio regardless of whether
   * we brightened or darkened the base color.
   * 
   * Text Contrast Hierarchy:
   * - High contrast (85% step): Hyperlinks and emphasized content
   * - Regular contrast (60% step): General text and main content
   * - Medium contrast (50% step): Secondary text and descriptions
   * - Low contrast (40% step): Subdued text and less important content
   */

  /* High-contrast text: 85% lightness step from surface - for hyperlinks */
  --on-surface-high-l: clamp(
    0,
    var(--surface-l) + 0.85 * var(--surface-sign),
    1
  );

  /* On-surface-high: High contrast text with proportional desaturation */
  --color-on-surface-high: oklch(
    var(--on-surface-high-l)
      calc(
        var(--surface-c) *
          min(
            var(--on-surface-high-l) / var(--surface-l),
            (1 - var(--on-surface-high-l)) / (1 - var(--surface-l))
          )
      )
      var(--surface-h)
  );

  /* Regular-contrast text: 60% lightness step from surface - for general content */
  --on-surface-l: clamp(0, var(--surface-l) + 0.6 * var(--surface-sign), 1);

  /* On-surface: Regular contrast text with proportional desaturation */
  --color-on-surface: oklch(
    var(--on-surface-l)
      calc(
        var(--surface-c) *
          min(
            var(--on-surface-l) / var(--surface-l),
            (1 - var(--on-surface-l)) / (1 - var(--surface-l))
          )
      )
      var(--surface-h)
  );

  /* Medium-contrast text: 50% lightness step from surface - for secondary content */
  --on-surface-variant-l: clamp(
    0,
    var(--surface-l) + 0.5 * var(--surface-sign),
    1
  );

  /* On-surface-variant: Medium contrast text with proportional desaturation */
  --color-on-surface-variant: oklch(
    var(--on-surface-variant-l)
      calc(
        var(--surface-c) *
          min(
            var(--on-surface-variant-l) / var(--surface-l),
            (1 - var(--on-surface-variant-l)) / (1 - var(--surface-l))
          )
      )
      var(--surface-h)
  );

  /* Low-contrast text: 40% lightness step from surface - for subdued content */
  --on-surface-low-l: clamp(0, var(--surface-l) + 0.4 * var(--surface-sign), 1);

  /* On-surface-low: Low contrast text with proportional desaturation */
  --color-on-surface-low: oklch(
    var(--on-surface-low-l)
      calc(
        var(--surface-c) *
          min(
            var(--on-surface-low-l) / var(--surface-l),
            (1 - var(--on-surface-low-l)) / (1 - var(--surface-l))
          )
      )
      var(--surface-h)
  );

  /* Calculated Primary Colors */

  /*
   * Primary Color System with Gamut-Safe Calculations
   * 
   * The primary color system uses the same proportional desaturation technique
   * as text colors to ensure all derived colors stay within the OKLCH gamut:
   * 
   * 1. Base primary: Uses defined OKLCH values directly
   * 2. Container colors: Averaged lightness between primary and surface
   * 3. Text colors: Calculated with sufficient contrast steps
   * 4. Chroma scaling: Prevents gamut overflow through proportional reduction
   * 
   * This ensures consistent color relationships and prevents browser
   * from clipping colors to sRGB boundaries.
   */

  /* Base primary color using defined OKLCH values */
  --color-primary: oklch(var(--primary-l) var(--primary-c) var(--primary-h));

  /* Text on primary: High contrast with gamut-safe chroma */
  --on-primary-l: clamp(
    0,
    var(--primary-l) + 0.55 * clamp(-1, (0.57 - var(--primary-l)) * infinity, 1),
    1
  );
  --color-on-primary: oklch(
    var(--on-primary-l)
      calc(
        var(--primary-c) *
          min(
            var(--on-primary-l) / var(--primary-l),
            (1 - var(--on-primary-l)) / (1 - var(--primary-l))
          )
      )
      var(--primary-h)
  );

  /* Container Strategy: Perceptual Midpoint for Balanced Contrast */

  /* 
   * Primary container lightness uses the average of primary and surface lightness.
   * This creates a perceptually balanced intermediate color that provides:
   * - Sufficient contrast against both primary and surface
   * - Visual hierarchy without being too prominent
   * - Consistent behavior across different base color combinations
   */
  --primary-container-l: calc((var(--primary-l) + var(--surface-l)) / 2);
  --color-primary-container: oklch(
    var(--primary-container-l)
      calc(
        var(--primary-c) *
          min(
            var(--primary-container-l) / var(--primary-l),
            (1 - var(--primary-container-l)) / (1 - var(--primary-l))
          )
      )
      var(--primary-h)
  );

  /* Text on primary container: High contrast with directional stepping */
  --on-primary-container-l: clamp(
    0,
    var(--primary-container-l) + 0.55 *
      clamp(-1, (0.57 - var(--primary-container-l)) * infinity, 1),
    1
  );
  --color-on-primary-container: oklch(
    var(--on-primary-container-l)
      calc(
        var(--primary-c) *
          min(
            var(--on-primary-container-l) / var(--primary-l),
            (1 - var(--on-primary-container-l)) / (1 - var(--primary-l))
          )
      )
      var(--primary-h)
  );

  /* Calculated Accent Colors */

  /*
   * Accent Color System - Mirror of Primary System
   * 
   * Uses identical calculation logic as primary colors to ensure:
   * - Consistent contrast behavior across color roles
   * - Predictable visual hierarchy
   * - Gamut-safe color derivation
   * 
   * Accent colors typically have higher chroma for visual interest
   * while maintaining the same mathematical relationships.
   */

  /* Base accent color using defined OKLCH values */
  --color-accent: oklch(var(--accent-l) var(--accent-c) var(--accent-h));

  /* Text on accent: High contrast with gamut-safe chroma */
  --on-accent-l: clamp(
    0,
    var(--accent-l) + 0.55 * clamp(-1, (0.57 - var(--accent-l)) * infinity, 1),
    1
  );
  --color-on-accent: oklch(
    var(--on-accent-l)
      calc(
        var(--accent-c) *
          min(
            var(--on-accent-l) / var(--accent-l),
            (1 - var(--on-accent-l)) / (1 - var(--accent-l))
          )
      )
      var(--accent-h)
  );

  /* 
   * Accent container uses the same midpoint strategy as primary container
   * for consistent visual behavior across color roles.
   */
  --accent-container-l: calc((var(--accent-l) + var(--surface-l)) / 2);
  --color-accent-container: oklch(
    var(--accent-container-l)
      calc(
        var(--accent-c) *
          min(
            var(--accent-container-l) / var(--accent-l),
            (1 - var(--accent-container-l)) / (1 - var(--accent-l))
          )
      )
      var(--accent-h)
  );

  /* Text on accent container: High contrast with directional stepping */
  --on-accent-container-l: clamp(
    0,
    var(--accent-container-l) + 0.55 *
      clamp(-1, (0.57 - var(--accent-container-l)) * infinity, 1),
    1
  );
  --color-on-accent-container: oklch(
    var(--on-accent-container-l)
      calc(
        var(--accent-c) *
          min(
            var(--on-accent-container-l) / var(--accent-l),
            (1 - var(--on-accent-container-l)) / (1 - var(--accent-l))
          )
      )
      var(--accent-h)
  );

  /* Calculated Interactive States using OKLCH */

  /*
   * Interactive State Colors
   * 
   * Uses accent color with low alpha for subtle state feedback.
   * OKLCH alpha blending provides more predictable results than
   * traditional RGB alpha blending, especially with saturated colors.
   */
  --color-hover: oklch(var(--accent-l) var(--accent-c) var(--accent-h) / 8%);
  --color-active: oklch(var(--accent-l) var(--accent-c) var(--accent-h) / 12%);

  /* Calculated Shadow Properties using OKLCH */

  /*
   * Adaptive Shadow System
   * 
   * Shadows are calculated to work across both light and dark themes:
   * 
   * 1. Shadow lightness: Always darker than surface (max 0.5 reduction)
   *    - Light themes: shadows are much darker than surface
   *    - Dark themes: shadows are slightly darker than surface
   * 
   * 2. Alpha values: Consistent across themes for predictable depth
   * 
   * 3. OKLCH color space: Ensures shadows don't shift hue unexpectedly
   *    compared to RGB-based shadow calculations
   */

  /* Shadow color: always darker than surface, theme-adaptive */
  --shadow-lightness: calc(max(0, var(--surface-l) - 0.5));

  /* Graduated alpha values for elevation hierarchy */
  --shadow-alpha-1: 0.15;
  --shadow-alpha-2: 0.12;
  --shadow-alpha-3: 0.1;
  --shadow-alpha-4: 0.08;
  --shadow-alpha-5: 0.06;

  /* Material Design Elevation Shadows with OKLCH Color Space */

  /*
   * Unified Shadow System - Compatible with Both Box Shadow and Text Shadow
   * 
   * These elevation variables use the three-value syntax (offset-x offset-y blur-radius color)
   * which is compatible with both box-shadow and text-shadow properties:
   * 
   * - For box-shadow: The spread-radius is omitted (equivalent to 0, no visual change)
   * - For text-shadow: Uses the exact same three-value syntax
   * 
   * This creates a single source of truth for elevation hierarchy across the design system,
   * eliminating code duplication and ensuring perfect consistency between box and text shadows.
   * 
   * Each elevation level uses Material Design's double-shadow technique:
   * 1. Ambient shadow: Larger, more diffuse (simulates ambient light)
   * 2. Key shadow: Smaller, sharper (simulates direct light source)
   */
  --elevation-0: none;
  --elevation-1:
    0 1px 3px oklch(var(--shadow-lightness) 0 0deg / var(--shadow-alpha-1)),
    0 1px 2px oklch(var(--shadow-lightness) 0 0deg / var(--shadow-alpha-2));
  --elevation-2:
    0 3px 6px oklch(var(--shadow-lightness) 0 0deg / var(--shadow-alpha-1)),
    0 2px 4px oklch(var(--shadow-lightness) 0 0deg / var(--shadow-alpha-2));
  --elevation-3:
    0 10px 20px oklch(var(--shadow-lightness) 0 0deg / var(--shadow-alpha-1)),
    0 6px 6px oklch(var(--shadow-lightness) 0 0deg / var(--shadow-alpha-3));
  --elevation-4:
    0 14px 28px oklch(var(--shadow-lightness) 0 0deg / var(--shadow-alpha-1)),
    0 10px 10px oklch(var(--shadow-lightness) 0 0deg / var(--shadow-alpha-3));
  --elevation-5:
    0 19px 38px oklch(var(--shadow-lightness) 0 0deg / var(--shadow-alpha-1)),
    0 15px 12px oklch(var(--shadow-lightness) 0 0deg / var(--shadow-alpha-4));

  /* Breakpoints */
  --breakpoint-sm: 680px;
  --breakpoint-md: 900px;
  --breakpoint-lg: 1200px;
  --breakpoint-xl: 1500px;
  --breakpoint-2xl: 1800px;

  /* Adaptive Spacing - Scales from mobile to desktop */

  /*
   * Responsive spacing that adapts to container width, similar to article padding.
   * Used for gaps, padding, and margins in card layouts where fixed spacing
   * would consume too much horizontal space on mobile screens.
   * 
   * - Mobile (narrow): 1rem (tight spacing)
   * - Desktop (wide): 3rem (generous spacing)
   * - Smooth transition based on container width
   */
  --spacing-adaptive: clamp(1rem, 6vw - 1rem, 3rem);
}

/* Theme Variants - Only Base OKLCH Values Need Changes */

/*
 * Theme System Design
 * 
 * Only the base OKLCH values (surface, primary, accent) need to be defined
 * for each theme. All derived colors (containers, text, shadows, etc.) are
 * automatically recalculated using the same mathematical relationships.
 * 
 * This ensures:
 * - Consistent contrast ratios across themes
 * - Predictable color relationships
 * - Minimal maintenance when adding new themes
 */

/* Dark Mode - Automatic based on system preference */
@media (prefers-color-scheme: dark) {
  :root {
    /* Dark theme base colors - all others automatically calculated */
    --surface-l: 0.27;
    --surface-c: 0.02;
    --surface-h: 254;
    --primary-l: 0.68;
    --primary-c: 0.1;
    --primary-h: 254;
    --accent-l: 0.85;
    --accent-c: 0.15;
    --accent-h: 44;
  }

  .astro-code,
  .astro-code span {
    color: var(--shiki-dark) !important;
    background-color: var(--shiki-dark-bg) !important;
  }
}

/* Photo Gallery Color Theme Overrides */

/*
 * Neutral Gray Color Scheme for Photo Gallery Pages
 * 
 * Photo galleries require a neutral, desaturated background to avoid
 * affecting the perceived white balance of displayed photos. Any color
 * cast in the background can make photos appear warmer or cooler than
 * they actually are.
 * 
 * This uses the same pattern as the theme switcher - an attribute on <html>
 * that overrides the :root variables with higher specificity.
 * 
 * Changes from default theme:
 * - Light theme: Darker background with reduced contrast
 * - Both themes: Zero chroma (surface-c = 0) for completely neutral grays
 * - All surface colors become pure grayscale with no hue bias
 */

/* Photo Gallery Light Theme Override */
[data-page-type="photo-gallery"] {
  /* Darker background: lightness ~0.85 for softer appearance */
  --surface-l: 0.85;

  /* Zero chroma: complete desaturation for neutral gray */
  --surface-c: 0;

  /* Hue becomes irrelevant when chroma is 0, but keep for consistency */
  --surface-h: 0;

  /* Slightly reduce primary contrast for gentler UI */
  --primary-l: 0.45;
  --primary-c: 0.12;

  /* Reduce accent prominence */
  --accent-l: 0.65;
  --accent-c: 0.15;
}

/* Photo Gallery Dark Theme Override */
@media (prefers-color-scheme: dark) {
  [data-page-type="photo-gallery"] {
    /* Keep dark theme darkness but ensure zero chroma */
    --surface-l: 0.27;

    /* Zero chroma: complete desaturation for neutral gray */
    --surface-c: 0;

    /* Hue becomes irrelevant when chroma is 0 */
    --surface-h: 0;

    /* Dark theme primary/accent overrides */
    --primary-l: 0.68;
    --primary-c: 0.1;
    --accent-l: 0.85;
    --accent-c: 0.15;
  }
}

@view-transition {
  navigation: auto;
}

/* Semantic Text Utilities (No TailwindCSS, DRY & Cascading) */

html,
body {
  margin: 0;
  padding: 0;
  min-height: 100vh;
  width: 100%;
  font-family: var(--font-sans);

  /* Responsive font size calculation:
   *
   * Formula: clamp(min, calc(min + (max - min) * ((100vw - min_width) / (max_width - min_width))), max)
   * Where:
   *   min = 16px (minimum font size)
   *   max = 22px (maximum font size)
   *   min_width = 400px (viewport width where scaling starts)
   *   max_width = 1920px (viewport width where scaling ends)
   *
   * Compact form derivation:
   *   multiplier = (max - min) / (max_width - min_width) = (22 - 16) / (1920 - 400) = 6 / 1520 ≈ 0.003947
   *   constant = min + multiplier * (-min_width) = 16 + 0.003947 * (-400) ≈ 16 - 1.579 ≈ 14.421
   *
   * This is equivalent to the following CSS:
   * font-size: clamp(16px, calc(16px + (22 - 16) * ((100vw - 400px) / (1920 - 400))), 22px);
   */
  font-size: clamp(16px, 0.395vw + 14.42px, 22px);
  line-height: 1.75;
  color: var(--color-on-surface);
  background-color: var(--color-surface-container);
  transition:
    background-color 0.2s ease-in-out,
    color 0.2s ease-in-out;
}

main {
  margin: 0 auto;
  padding: 0;
}

a {
  color: inherit;
  text-decoration: underline;
  text-decoration-color: transparent;
  text-decoration-thickness: 0.3ex;
  text-decoration-skip-ink: none;
  text-underline-offset: 0.6ex;
  transition:
    text-decoration-color 0.2s ease-out,
    text-underline-offset 0.2s ease-out;
}

/* Unordered lists */

/* Square bullets are more cohesive with the overall design */
ul {
  list-style-type: square;
}

/* Buttons */
button {
  color: var(--color-on-primary);
  background-color: var(--color-primary);
  border: none;
  border-radius: 0.2rem;
  padding: 0.875rem 1.5rem;
  cursor: pointer;
  box-shadow: var(--elevation-2);

  /* Smooth transitions */
  transition:
    background-color 0.2s ease-in-out,
    box-shadow 0.2s ease-in-out,
    transform 0.1s ease-in-out;
}

/* Horizontal container for icon + text */
button,
label {
  /* Flex layout for icon + text */
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5em;
}

/* Icon inside horizontal container */
button svg,
label svg {
  width: 1.5rem;
  height: 1.5rem;
  flex-shrink: 0;
}

/* Contact Form Styles */

/* Common styles for input and textarea */
input,
textarea {
  outline: none;
}

/* Common styles for label and textarea */
label,
textarea {
  font-family: var(--font-serif);

  /* Surface container for input fields */
  background-color: var(--color-surface);
  color: var(--color-on-surface);

  /* Spacing and border */
  border: 0.1rem solid var(--color-surface-container-high);
  border-radius: 0.2rem;
  padding: 0.75rem 1rem;

  /* Smooth transitions for focus states */
  transition:
    border-color 0.2s ease-in-out,
    box-shadow 0.2s ease-in-out;
}

/* Input fields inside labels */
input {
  flex: 1;
  border: none;
  background: transparent;
}

/* Textarea - Message field */
textarea {
  min-height: 10rem;
  resize: vertical;
}

/* Icons in form labels */
label svg {
  color: var(--color-primary);
}

/* Headings: style h1-h4 directly, sans-serif, letter-spacing */
h1,
h2,
h3,
h4 {
  font-family: var(--font-sans);
  letter-spacing: -0.02em;
}

/* h1 styles */
h1 {
  font-size: 4rem;
  font-weight: 250;
  line-height: 1;
  margin-block: 0.3em;
}

/* h2 styles */
h2 {
  font-size: 2.7rem;
  line-height: 1.1;
  font-weight: 320;
  margin-block: 0.5em;

  /* border-top: 0.1em solid var(--color-primary); */
}

/* h3 styles */
main > header p,
h3 {
  font-size: 1.8rem;
  line-height: 1.2;
  font-weight: 370;
  margin-block: 0.7em;
}

/* h4 fonts */
blockquote,
header li,
main nav li,
button,
h4 {
  font-size: 1.3rem;
  font-weight: 420;
}

/* h4 spacing */
h4 {
  margin-block: 0.9em;
  line-height: 1.3;
}

main > article {
  /*
   * Paper-like article container with coordinated width and padding:
   * 
   * Design goal: Create a sheet of paper effect where the container grows
   * from 32rem to 42rem, while padding grows from minimal to generous.
   * 
   * Key insight: Content area is fixed at 30rem width on wide screens.
   * When viewport is narrower than 30rem + 2rem padding = 32rem total,
   * we're on a narrow screen and need different behavior.
   */
  max-width: clamp(32rem, 100%, 42rem);
  margin: 0 auto;

  /*
   * Responsive padding calculation:
   * 
   * (100% - 30rem) tells us how much extra space we have beyond the 30rem content width:
   * - Wide screens: Positive value = extra space available for generous padding
   * - Narrow screens: Negative value = constrained space, use minimal padding
   * 
   * Division by 2 distributes the extra space equally to left and right padding.
   * Result: Content stays 30rem wide on wide screens, adapts gracefully on narrow screens.
   */
  padding: 2.5rem clamp(1rem, (100% - 30rem) / 2, 6rem);
  color: inherit;
  background-color: var(--color-surface);
  box-shadow: var(--elevation-1);

  /* Use serif font for article body text for better readability */
  font-family: var(--font-serif);

  /* Give more flesh to Bitter Variable */
  font-weight: 450;
}

/* Accent links in articles with higher contrast */
main article a {
  color: var(--color-on-surface-high);
  font-weight: 500;
}

article h1 a,
article h2 a,
article h3 a,
article h4 a {
  color: inherit;
  font-weight: inherit;
}

/*
 * Heading Visual Hierarchy with Sheet Border Bars
 * 
 * Design goal: Create visual hierarchy bars that appear to extend from the
 * article's "paper borders" while keeping heading text aligned with body content.
 * 
 * Key insight: Same logic as article padding - (100% - 30rem) determines if we're
 * on wide screens (positive value) or narrow screens (negative value).
 */
article h1,
article h2,
article h3,
article h4 {
  border-left-color: var(--color-primary);
  border-left-width: 0.1em;

  /*
   * Responsive left padding:
   * - Uses (100% - 30rem) to detect screen width relative to content area
   * - Wide screens: Extra space allows generous bar extension
   * - Narrow screens: Minimal padding prevents overflow
   */
  padding: 0.2em 0 0.2em clamp(0.1em, 100% - 30rem + 0.2em, 0.2em);

  /*
   * Responsive left margin:
   * - Pulls bars leftward into the article's padding area
   * - Wide screens: Can pull further left due to generous padding
   * - Narrow screens: Limited leftward pull to prevent overflow
   */
  margin-left: clamp(-0.4em, 30rem - 100% - 0.4em, -0.2em);
}

/* Bar style represents different heading levels */
article h1,
article h2 {
  border-left-style: solid;
}

article h3 {
  border-left-style: dashed;
}

article h4 {
  border-left-style: dotted;
}

/* Metadata footer right after the article */
main > article + footer {
  color: var(--color-on-surface-variant);
  text-align: center;
  margin: 3rem max(1rem, (100% - 42rem) / 2);
}

article img {
  max-width: 100%;
  height: auto;
  box-shadow: var(--elevation-1);
  border-radius: 0.2rem;
}

/* Surface block containers */
pre,
blockquote,
fieldset {
  background-color: var(--color-surface-container-lowest);
  padding: 0.5rem 1rem;
  border-radius: 0.2rem;
}

/* Surface inline containers */
kbd,
code {
  background-color: var(--color-surface-container-low);
  padding: 0.125em 0.25em;
  border-radius: 0.25rem;
}

/* Blockquote shares some styles with h4 and uses surface container */
blockquote {
  color: var(--color-on-surface-variant);
  box-shadow: var(--elevation-1);
  position: relative;

  /* Blockquote uses the same typography as <h4>, so we need to add missing styles */
  font-family: var(--font-sans);
  margin-inline: 0;
}

blockquote::before {
  content: "\201C";
  position: absolute;
  top: -1rem;
  left: 1rem;
  font-size: 5rem;
  font-weight: 500;
  color: var(--color-primary);
  line-height: 1;
  text-shadow: var(--elevation-2);
}

/* Code Elements */
code,
pre,
kbd,
samp {
  font-family: var(--font-mono);
  font-size: 1.1em;
}

pre {
  padding: 1rem;
  border-radius: 0.2rem;
  overflow-x: auto;
  line-height: 1.4;
  box-shadow: var(--elevation-1);
  font-size: 1em;
}

/* Reset styles for code blocks because they are styled with Shiki */
pre code {
  background: none;
  padding: 0;
  border-radius: 0;
  font-size: inherit;
}

kbd {
  border: 1px solid var(--color-surface-container-highest);
  box-shadow: var(--elevation-1);
  font-size: 1em;
}

/* Horizontal Rule - Material Design divider styling */
article hr {
  width: 70%;
  border-width: 0 0.5rem 0.15rem 0;
  border-color: var(--color-primary);
  height: 0.55rem;
  background-color: inherit;
  margin-inline: auto -0.5rem;
  padding: 0;
}

/* List Elements - Subdued markers for better content hierarchy */
ul > li::marker,
ol > li::marker {
  color: var(--color-primary);
  font-family: var(--font-sans);
  font-weight: 550;
  font-size: 1.2em;
}

/* Table Elements - Material Design inspired styling */
table {
  width: 100%;
  border-collapse: collapse;
  margin: 1.5rem 0;
  background-color: var(--color-surface);
  color: var(--color-on-surface);
  border-radius: 0.2rem;
  box-shadow: var(--elevation-1);
}

thead {
  background-color: var(--color-surface-container-low);
}

th {
  font-family: var(--font-sans);
  font-weight: 500;
  font-size: 1.1em;
  text-align: left;
  padding: 0.5rem 1rem;
  border-bottom: 0.15rem solid var(--color-primary);
}

td {
  padding: 0.5rem 1rem;
  font-size: 0.9em;
  border-bottom: 0.07rem solid var(--color-surface-container);
  transition: background-color 0.2s ease-in-out;
}

/* Alternating row colors for better readability */
tbody tr:nth-child(even) {
  background-color: var(--color-surface-container-lowest);
}

tbody tr:hover {
  background-color: var(--color-surface-container-low);
}

tbody tr:last-child td {
  border-bottom: none;
}

/* All navigation inside headers are horizontal */
nav ul {
  list-style: none;
  display: flex;
  flex-wrap: wrap;
  gap: 1em;
  padding-inline: 0;
}

/* Photo gallery - CSS Grid masonry with known aspect ratios */
main > ul {
  list-style: none;
  display: grid;

  /* Responsive columns - adjust minmax for desired density */
  grid-template-columns: repeat(auto-fill, minmax(5rem, 1fr));
  gap: 1.5rem;
  padding: var(--spacing-adaptive);

  /* There is no horizontal limit, the masonry grid fills all available space */

  /* Center items vertically within their grid areas */
  align-items: center;
}

/* Hero section */
main > nav ul,
main > header ul {
  justify-content: center;
}

/* Navigation bar */
body > header ul {
  justify-content: flex-end;
}

body > header,
main > header {
  background: var(--color-surface-container-low);
  box-shadow: var(--elevation-2);

  /* In combination with z-index, ensures the shadow appears above other content */
  position: relative;

  /* Flexbox layout with centered content */
  display: flex;
  align-items: center;
  text-align: center;

  /* Limit the content width inside the header to 42rem */
  padding-inline: max(1rem, (100% - 42rem) / 2);
}

/* Navbar styles */
body > header {
  /* Fixed position at the top of the document */
  top: 0;

  /* Ensures the shadow appears above other content */
  z-index: 2;

  /* Spread out logo and nav items */
  justify-content: space-between;

  /* Gap between logo and nav */
  gap: 1rem;
}

/* Hero header */
main > header {
  /* Centered content with vertical stacking */
  flex-direction: column;
  justify-content: center;

  /* Generous vertical padding for spacious hero section */
  padding-block: 3rem;

  /* Ensure the shadow appears above other content */
  z-index: 1;
}

/* Subtitle styles in hero header */
main > header p {
  font-family: var(--font-serif);
  color: var(--color-on-surface-variant);
  font-style: italic;
}

/* Logo size in the header */
body > header svg {
  /*
   * By default, SVGs can be treated as inline elements, which can cause
   * unexpected extra space below them due to baseline alignment. Setting
   * display to "block" removes this behavior and ensures the element's
   * bounds match its visual appearance, fixing vertical alignment issues
   * within flex containers.
   */
  display: block;
  height: 1.7rem;
  width: auto;
  transition: transform 0.2s ease-in-out;
}

body > header svg:hover {
  /*
   * Unlike other links on the website that use underline-based hover effects,
   * the logo SVG needs a different hover animation because it contains no text
   * or labels. The underline hover effect doesn't work on SVG elements, so we
   * use a subtle scale transform to indicate that the logo is clickable and
   * serves as a navigation link.
   */
  transform: scale(1.05);
}

/* Blog post index - vertical stack with ordered list */
main > ol {
  list-style: none;
  max-width: 42rem;
  margin: 0 auto;
  padding: var(--spacing-adaptive);
  display: flex;
  flex-direction: column;
  gap: var(--spacing-adaptive);
}

/* Blog post cards in vertical layout - text only, no images */
main > ol article {
  background-color: var(--color-surface);
  border-radius: 0.2rem;
  box-shadow: var(--elevation-2);
  transition: box-shadow 0.2s ease-in-out;
  padding: var(--spacing-adaptive);
  font-family: var(--font-serif);
  font-weight: 450;
}

main > ol article:hover {
  box-shadow: var(--elevation-3);
}

/* === Grid Layout Classes === */

/* These control how much space the card occupies on the grid */

/* Grid layout: Landscape cards - wider span */
main > ul .grid-landscape {
  grid-row: span 2;
  grid-column: span 3;
}

/* Grid layout: Square cards - balanced span */
main > ul .grid-square {
  grid-row: span 2;
  grid-column: span 2;
}

/* Grid layout: Portrait cards - taller span */
main > ul .grid-portrait {
  grid-row: span 3;
  grid-column: span 2;
}

/*
 * Polaroid-Style Photo Cards with Perceptual White Balance Strategy
 * 
 * Design Goal: Create photo cards that look like physical Polaroid prints with
 * white borders that serve both aesthetic and functional purposes.
 * 
 * WHY NOT USE GENERATED OKLCH COLORS HERE?
 * 
 * Unlike the rest of the site, these cards use fixed off-white colors (90-95%
 * lightness) that don't change with the theme. This intentional deviation from
 * the global color system serves multiple purposes:
 * 
 * 1. Polaroid Visual Aesthetic
 *    Physical Polaroid prints have white borders that don't change based on
 *    ambient lighting. This fixed white border creates an authentic tactile
 *    feeling and makes photos look like physical objects rather than digital
 *    elements that adapt to the theme.
 * 
 * 2. White Balance Reference Point
 *    The fixed off-white border provides a consistent white balance reference
 *    for the viewer's eye. When viewing photos:
 *    
 *    a) Under non-ideal ambient lighting (warm/cool room lighting):
 *       - Both the photo and border will be affected by the same color cast
 *       - The human visual system will use the "white" border as a reference
 *       - This recalibrates perception, making the photo colors appear more accurate
 *    
 *    b) On displays with incorrect white balance:
 *       - The entire image + border shifts together
 *       - The viewer's eye adapts using the border as the "white" anchor
 *       - This compensates for display calibration issues
 * 
 * 3. Perceptual Contrast Boost
 *    The border uses 90-95% white instead of pure 100% white. Combined with
 *    the deliberately darker, desaturated background (see data-page-type
 *    overrides above), this creates a perceptual contrast enhancement:
 *    
 *    - The viewer's eye perceives the border as "pure white" in context
 *    - Any 100% white elements in the photo itself appear even brighter
 *    - This increases the perceived dynamic range of the photos
 *    - Black elements appear deeper against the bright border
 * 
 * 4. Coordination with Page Background
 *    Pages with data-page-type="photo-gallery" have:
 *    - Darker background (surface-l: 0.85 in light mode)
 *    - Zero chroma (surface-c: 0) to avoid color cast interference
 *    
 *    This creates a viewing environment similar to a photo mat or gallery wall
 *    where the darker surround makes the bright photo borders "pop" visually.
 * 
 * Technical Implementation:
 * - Light theme: 95% lightness border
 * - Dark theme: 90% lightness border (maintains contrast difference)
 * - Zero chroma (0) ensures pure neutral gray-white
 * - Zero hue (0deg) becomes irrelevant with zero chroma
 * 
 * Note: These design principles may be expanded into a blog post about the
 * site's visual design system.
 */

/* Figure container fills anchor and positions caption relative to image */
main > ul figure {
  margin: 0;

  /* Polaroid-style card: white background with shadow and rounded corners */
  border-radius: 0.2rem;
  box-shadow: var(--elevation-2);

  /* Fixed off-white background - NOT theme-adaptive (see explanation above) */
  background-color: oklch(95% 0 0deg);

  /* Base padding around image (will be overridden for caption sides) */
  padding: 0.5rem;

  /* Smooth transitions for hover effects */
  transition:
    box-shadow 0.2s ease-in-out,
    scale 0.2s ease-in-out,
    rotate 0.2s ease-in-out;
}

@media (prefers-reduced-motion: reduce) {
  main > ul figure {
    transition: none;
  }
}

@media (prefers-color-scheme: dark) {
  main > ul figure {
    /* Slightly darker off-white for dark theme - still provides white balance reference */
    background-color: oklch(90% 0 0deg);
  }
}

/* === Caption Placement Classes === */

/* These control padding to accommodate captions at different positions */

/* Caption placement: Bottom (for landscape and square-ish photos) */
.caption-bottom figure {
  padding-bottom: 2rem;
}

/* Caption placement: Side (for portrait photos) */
.caption-side figure {
  padding-left: 2rem;
}

/* Image fills available space with no extra styling */
main > ul img {
  display: block;
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/*
 * Photo Caption Styling - Fixed Dark Gray on White
 * 
 * Like the border background, the caption color is intentionally NOT derived
 * from the global OKLCH color system. This fixed dark gray (45% lightness)
 * maintains the Polaroid aesthetic where captions are handwritten or printed
 * in dark ink on the white border.
 * 
 * Design rationale:
 * - Provides strong, consistent contrast against the 90-95% white border
 * - Doesn't change with theme, maintaining the "physical object" illusion
 * - Zero chroma keeps it neutral to avoid competing with photo colors
 * - 45% lightness is dark enough to be easily readable but not harsh
 */

/* Caption base styles - always visible, single line with ellipsis */
main > ul figcaption {
  position: absolute;
  font-size: 0.8rem;
  font-family: var(--font-mono);
  font-weight: 600;
  white-space: nowrap;
  text-overflow: ellipsis;
  line-height: 1.2;

  /* Fixed dark gray - NOT theme-adaptive (see explanation above) */
  color: oklch(45% 0 0deg);
}

/* === Caption Positioning Classes === */

/* These control where the caption appears within the figure */

/* Caption positioning: Bottom */
main > ul .caption-bottom figcaption {
  bottom: 0.5rem;
  left: 0.5rem;
  right: 0.5rem; /* This constrains the width for ellipsis to work */

  /* Trim text that overflows horizontally, but allow vertical overflow */
  overflow-x: clip;
}

/* Caption positioning: Side (rotated 90 degrees) */
main > ul .caption-side figcaption {
  top: 0.5rem;
  left: 0.5rem;
  bottom: 0.5rem; /* This constrains the height (becomes width in vertical mode) */

  /* Trim text that overflows vertically, but allow horizontal overflow */
  overflow-y: clip;

  /* Rotate text 90 degrees: vertical-rl makes text flow from top to bottom */
  writing-mode: vertical-rl;
}

/* Hover effect: scale entire figure (image + caption together) and increase shadow */
main > ul figure:hover,
main > ul a:focus-visible figure {
  scale: 1.02;
  rotate: 0deg !important; /* Straighten the card on hover - important needed to override inline styles */
  box-shadow: var(--elevation-3);
}

/* Pagination navigation - centered in main */
main > nav {
  margin-block: 3rem;
  text-align: center;
  max-width: 42rem;
  margin-inline: auto;
  padding: 0 1rem;
}

main > nav span[aria-disabled="true"] {
  color: var(--color-on-surface-low);
  cursor: not-allowed;
}

/* Hierarchical date navigation with nested ordered lists */
nav ol {
  list-style: none;
  padding-inline: 0;
}

/* Date in article header */
time {
  color: var(--color-on-surface-variant);
  font-size: 0.9em;
  font-style: italic;
}

/*
 * Form as Direct Child of Main - Contact Form Pattern
 * 
 * Design: Forms that appear as direct children of main are styled as
 * clean interactive cards with generous spacing and clear hierarchy.
 */
main > form {
  /* Centered with comfortable max-width */
  max-width: 32rem;
  margin: 0 auto;
  padding: var(--spacing-adaptive);
  background-color: var(--color-surface-container-low);
  box-shadow: var(--elevation-2);
  border-radius: 0.2rem;

  /* Vertical stack of form elements */
  display: flex;
  flex-direction: column;
  gap: 1rem;

  /* Use larger font size for inputs */
  font-size: 1.2rem;
}

/* Page footer styles */

body > footer {
  /* Theme-aware muted background */
  background-color: var(--color-surface-container-highest);
  color: var(--color-on-surface-variant);

  /* Inner shadow on top using Material Design elevation */
  box-shadow: inset 0 4px 6px -2px
    hsl(0deg 0% var(--shadow-lightness) / var(--shadow-alpha-2));

  /* Layout - style footer directly */
  display: flex;
  flex-direction: column;
  gap: 2em;
  padding: 2em 0;
  margin-top: 3em;
}

/* Hover and active states */

/* Links */
a:hover {
  text-decoration-color: var(--color-accent);
  text-underline-offset: 0.3ex;
}

a:active {
  background-color: var(--color-accent);
  color: var(--color-on-accent);
}

a:focus-visible,
main > ul a:focus-visible figure {
  outline: 0.2rem solid var(--color-accent);
  outline-offset: 0.2rem;
}

::selection {
  background-color: var(--color-accent);
  color: var(--color-on-accent);
}

/* Button hover state */
button:hover {
  background-color: oklch(
    calc(var(--primary-l) * 1.1) var(--primary-c) var(--primary-h)
  );
  box-shadow: var(--elevation-3);
}

/* Button active state */
button:active {
  transform: scale(0.98);
  box-shadow: var(--elevation-1);
}

/* Form input placeholder text */
input::placeholder,
textarea::placeholder {
  color: var(--color-on-surface-low);
}

/* Focus state for labels when input is focused */
label:focus-within,
textarea:focus {
  border-color: var(--color-accent);
  box-shadow: 0 0 0 0.2rem var(--color-accent-container);
}

/* Invalid state - show error indicator only after user interaction */
label:has(input:user-invalid),
textarea:user-invalid {
  background-color: var(--color-accent-container);
  color: var(--color-on-accent-container);
}

/* source-sans-3-latin-wght-normal */
@font-face {
  font-family: "Source Sans 3 Variable";
  font-style: normal;
  font-display: block;
  font-weight: 200 900;
  src: url("@fontsource-variable/source-sans-3/files/source-sans-3-latin-wght-normal.woff2")
    format("woff2-variations");
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC,
    U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212,
    U+2215, U+FEFF, U+FFFD;
}

/* source-sans-3-latin-wght-italic */
@font-face {
  font-family: "Source Sans 3 Variable";
  font-style: italic;
  font-display: block;
  font-weight: 200 900;
  src: url("@fontsource-variable/source-sans-3/files/source-sans-3-latin-wght-italic.woff2")
    format("woff2-variations");
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC,
    U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212,
    U+2215, U+FEFF, U+FFFD;
}

/* bitter-latin-wght-normal */
@font-face {
  font-family: "Bitter Variable";
  font-style: normal;
  font-display: block;
  font-weight: 100 900;
  src: url("@fontsource-variable/bitter/files/bitter-latin-wght-normal.woff2")
    format("woff2-variations");
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC,
    U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212,
    U+2215, U+FEFF, U+FFFD;
}

/* bitter-latin-wght-italic */
@font-face {
  font-family: "Bitter Variable";
  font-style: italic;
  font-display: block;
  font-weight: 100 900;
  src: url("@fontsource-variable/bitter/files/bitter-latin-wght-italic.woff2")
    format("woff2-variations");
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC,
    U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212,
    U+2215, U+FEFF, U+FFFD;
}

/* inconsolata-latin-wght-normal */
@font-face {
  font-family: "Inconsolata Variable";
  font-style: normal;
  font-display: block;
  font-weight: 200 900;
  src: url("@fontsource-variable/inconsolata/files/inconsolata-latin-wght-normal.woff2")
    format("woff2-variations");
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC,
    U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212,
    U+2215, U+FEFF, U+FFFD;
}
