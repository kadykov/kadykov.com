---
import OptimizedImage from "./OptimizedImage.astro"

interface Props {
  src: string
  alt: string
  title?: string
}

const { src, alt, title } = Astro.props

// Check if it's an image that can be optimized (common image extensions)
const imageExtensions = [
  ".jpg",
  ".jpeg",
  ".png",
  ".webp",
  ".avif",
  ".gif",
  ".bmp",
  ".tiff",
]
const isOptimizableImage = imageExtensions.some((ext) =>
  src.toLowerCase().endsWith(ext)
)

// Images should be displayed at full width for better visual impact
// Maximum width: 1200px for optimal viewing experience
const IMAGE_MAX_WIDTH = 1200
---

{
  !isOptimizableImage ? (
    <img
      src={src}
      alt={alt}
      title={title}
      loading="lazy"
      decoding="async"
      style="display: block; width: 100%; height: auto; max-width: 100%;"
    />
  ) : (
    <OptimizedImage
      src={src}
      alt={alt}
      displayWidth={IMAGE_MAX_WIDTH}
      sizesAttr="(max-width: 1200px) calc(100vw - 48px), 1200px"
      loading="lazy"
      decoding="async"
    />
  )
}
