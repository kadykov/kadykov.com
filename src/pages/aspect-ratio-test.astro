---
import BaseLayout from "../layouts/BaseLayout.astro"

// Generate test photos with various aspect ratios
// Using placeholder service that doesn't require actual image generation
interface TestPhoto {
  width: number
  height: number
  aspectRatio: number
}

const testPhotos: TestPhoto[] = []

// Generate a range of aspect ratios from 0.4 (very portrait) to 2.0 (very landscape)
// with more density around the boundary values (0.85 and 1.2)
const aspectRatios = [
  2.0,
  1.8,
  1.6,
  1.4,
  1.3,
  1.25,
  1.2, // Landscape range
  1.15,
  1.1,
  1.05,
  1.0,
  0.95,
  0.9,
  0.85, // Square range
  0.8,
  0.75,
  0.7,
  0.6,
  0.5,
  0.4, // Portrait range
]

// Create photos with consistent base width
const baseWidth = 1600
aspectRatios.forEach((ratio) => {
  const height = Math.round(baseWidth / ratio)
  testPhotos.push({
    width: baseWidth,
    height,
    aspectRatio: ratio,
  })
})

// Classification logic (from PhotoGallery.astro)
function getAspectClass(width: number, height: number): string {
  const ratio = width / height
  if (ratio >= 1.2) return "photo-horizontal"
  if (ratio < 0.85) return "photo-vertical"
  return "photo-square"
}

const frontmatter = {
  title: "Aspect Ratio Test - Photo Gallery Classification",
  description: "Test page for photo gallery aspect ratio classification",
}
---

<BaseLayout frontmatter={frontmatter}>
  <Fragment slot="head">
    <title>Aspect Ratio Test - Photo Gallery Classification</title>
  </Fragment>

  <main>
    <h1>Photo Gallery Aspect Ratio Classification Test</h1>
    <p style="margin-bottom: 2rem;">
      Current ranges: <strong>Landscape</strong> ≥ 1.2 | <strong>Square</strong
      >{" "}
      0.85–1.2 | <strong>Portrait</strong> &lt; 0.85
    </p>

    {/* Use exact same markup structure as PhotoGallery.astro */}
    <ul>
      {
        testPhotos.map((photo) => {
          const aspectClass = getAspectClass(photo.width, photo.height)
          const placeholderUrl = `https://placehold.co/${photo.width}x${photo.height}/6366f1/white?text=${photo.aspectRatio.toFixed(2)}`

          return (
            <li class={aspectClass}>
              <a class="gallery-item" href="#" target="_blank">
                <figure>
                  <picture>
                    <img
                      src={placeholderUrl}
                      alt={`Test photo ${photo.aspectRatio.toFixed(2)}`}
                      width={photo.width}
                      height={photo.height}
                      loading="lazy"
                      decoding="async"
                    />
                  </picture>
                  <figcaption>
                    Ratio: {photo.aspectRatio.toFixed(2)} (
                    {aspectClass.replace("photo-", "")})
                  </figcaption>
                </figure>
              </a>
            </li>
          )
        })
      }
    </ul>
  </main>
</BaseLayout>
