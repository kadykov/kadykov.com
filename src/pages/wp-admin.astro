---
// Easter egg: Fake WordPress admin login page
import { Icon } from "astro-icon/components"
import "../styles/wp.css"
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="noindex, nofollow" />
    <title>Log In ‚Äπ Kadykov ‚Äî WordPress</title>
  </head>
  <body class="login">
    <div id="login">
      <h1>
        <a href="/">
          <Icon name="fa:wordpress" size={84} />
          <span class="screen-reader-text">Kadykov</span>
        </a>
      </h1>
      <form name="loginform" id="loginform" method="post">
        <p>
          <label for="user_login">Username or Email Address</label>
          <input
            type="text"
            name="log"
            id="user_login"
            class="input"
            value=""
            size="20"
            autocapitalize="off"
            autocomplete="username"
            required
          />
        </p>

        <div class="user-pass-wrap">
          <label for="user_pass">Password</label>
          <div class="wp-pwd">
            <input
              type="password"
              name="pwd"
              id="user_pass"
              class="input password-input"
              value=""
              size="20"
              autocomplete="current-password"
              required
            />
            <button
              type="button"
              class="password-toggle"
              aria-label="Show password"
            >
              <Icon name="fa:eye" class="icon-show" size={18} />
              <Icon
                name="fa:eye-slash"
                class="icon-hide"
                size={18}
                style="display: none;"
              />
            </button>
          </div>
        </div>

        <div class="submit-row">
          <p class="forgetmenot">
            <input
              name="rememberme"
              type="checkbox"
              id="rememberme"
              value="forever"
            />
            <label for="rememberme">Remember Me</label>
          </p>

          <p class="submit">
            <input
              type="submit"
              name="wp-submit"
              id="wp-submit"
              class="button button-primary button-large"
              value="Log In"
            />
          </p>
        </div>
      </form>

      <p id="nav">
        <!-- TODO: Add a blog post about password managers -->
        <a href="/">Lost your password?</a>
      </p>

      <p id="backtoblog">
        <a href="/">‚Üê Go to Kadykov</a>
      </p>
    </div>

    <!-- Modal for responses -->
    <div id="responseModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Response</h2>
        </div>
        <div class="modal-body" id="modalBody"></div>
        <div class="modal-footer">
          <button class="modal-button" id="closeModal">Close</button>
        </div>
      </div>
    </div>

    <script>
      const form = document.getElementById("loginform") as HTMLFormElement
      const modal = document.getElementById("responseModal") as HTMLElement
      const modalTitle = document.getElementById("modalTitle") as HTMLElement
      const modalBody = document.getElementById("modalBody") as HTMLElement
      const closeBtn = document.getElementById(
        "closeModal"
      ) as HTMLButtonElement
      const passwordInput = document.getElementById(
        "user_pass"
      ) as HTMLInputElement
      const passwordToggle = document.querySelector(
        ".password-toggle"
      ) as HTMLButtonElement

      // Password visibility toggle
      passwordToggle.addEventListener("click", () => {
        const type = passwordInput.type === "password" ? "text" : "password"
        passwordInput.type = type

        // Toggle icons
        const iconShow = passwordToggle.querySelector(
          ".icon-show"
        ) as HTMLElement
        const iconHide = passwordToggle.querySelector(
          ".icon-hide"
        ) as HTMLElement

        if (iconShow && iconHide) {
          iconShow.style.display = type === "password" ? "block" : "none"
          iconHide.style.display = type === "password" ? "none" : "block"
        }

        passwordToggle.setAttribute(
          "aria-label",
          type === "password" ? "Show password" : "Hide password"
        )
      })

      closeBtn.addEventListener("click", () => {
        modal.classList.remove("show")
      })

      modal.addEventListener("click", (e) => {
        if (e.target === modal) {
          modal.classList.remove("show")
        }
      })

      // Simple password strength checker
      function isWeakPassword(password: string): boolean {
        // Common weak passwords and patterns
        const commonPasswords = [
          "password",
          "123456",
          "12345678",
          "qwerty",
          "abc123",
          "monkey",
          "1234567",
          "letmein",
          "trustno1",
          "dragon",
          "baseball",
          "iloveyou",
          "master",
          "sunshine",
          "ashley",
          "bailey",
          "passw0rd",
          "shadow",
          "123123",
          "654321",
          "superman",
          "qazwsx",
          "michael",
          "football",
          "admin",
          "welcome",
          "login",
          "password1",
          "Password1",
          "test",
        ]

        // Check if password is in common list
        if (commonPasswords.includes(password.toLowerCase())) {
          return true
        }

        // Check for simple patterns
        if (password.length < 8) {
          return true
        }

        // Check if it's only numbers
        if (/^\d+$/.test(password)) {
          return true
        }

        // Check if it's only letters
        if (/^[a-zA-Z]+$/.test(password)) {
          return true
        }

        // Check for keyboard patterns
        const keyboardPatterns = [
          "qwerty",
          "asdfgh",
          "zxcvbn",
          "12345",
          "09876",
        ]
        for (const pattern of keyboardPatterns) {
          if (password.toLowerCase().includes(pattern)) {
            return true
          }
        }

        return false
      }

      form.addEventListener("submit", (e) => {
        e.preventDefault()

        const username = (
          document.getElementById("user_login") as HTMLInputElement
        ).value
        const password = (
          document.getElementById("user_pass") as HTMLInputElement
        ).value

        if (isWeakPassword(password)) {
          // Weak password response
          modalTitle.textContent = `ü§î Really, ${username}?`
          modalBody.innerHTML = `
					<p><strong>Do you really think I use such an insecure password?</strong></p>
					<p>Using weak passwords is one of the biggest security risks online. Even for fake login pages like this one, it's good practice to think about password security!</p>
					<p><strong>Pro tip:</strong> Use a password manager like <a href="https://bitwarden.com/" target="_blank" rel="noopener">Bitwarden</a>, <a href="https://1password.com/" target="_blank" rel="noopener">1Password</a>, or <a href="https://www.keepass.info/" target="_blank" rel="noopener">KeePass</a> to generate and store strong, unique passwords for every site.</p>
					<p>Your future self will thank you! üîê</p>
				`
        } else {
          // Strong password response
          modalTitle.textContent = `üéâ Nice Try, ${username}!`
          modalBody.innerHTML = `
					<p><strong>Do you really think this site is powered by WordPress?</strong></p>
					<p>This website is actually built with <a href="https://astro.build/" target="_blank" rel="noopener">Astro</a>, a modern static site generator that delivers fast, content-focused websites.</p>
					<p>If you're curious about how this site was built and why I chose Astro:</p>
					<ul style="margin-left: 20px; margin-bottom: 12px;">
						<li>Check out the <a href="/about">About page</a> for more details</li>
						<li>Browse the <a href="https://github.com/kadykov/kadykov.com" target="_blank" rel="noopener">source code on GitHub</a></li>
					</ul>
					<p>And hey, nice password! It looks reasonably secure. Keep using strong passwords! üí™</p>
				`
        }

        modal.classList.add("show")
      })

      // Easter egg hint in console
      console.log(
        "%cüé≠ Easter Egg Found!",
        "font-size: 20px; color: #2271b1; font-weight: bold;"
      )
      console.log(
        "%cYou discovered the fake WordPress admin page!",
        "font-size: 14px; color: #3c434a;"
      )
      console.log(
        "%cTry logging in with different passwords to see what happens...",
        "font-size: 12px; color: #666;"
      )
    </script>
  </body>
</html>
