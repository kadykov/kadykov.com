---
import { getCollection } from "astro:content"
import BaseLayout from "../../layouts/BaseLayout.astro"
import Hero from "../../components/Hero.astro"
import BlogPostList from "../../components/BlogPostList.astro"
import { getFontPreload } from "../../config/fontPreload"

const allPosts = (
  await getCollection("blog", ({ data }) => data.draft !== true)
).sort((a, b) => {
  const dateA = a.data.pubDate?.getTime() ?? 0
  const dateB = b.data.pubDate?.getTime() ?? 0
  return dateB - dateA // Most recent first
})

const frontmatter = {
  title: "Blog",
  description: "Blog posts about web development, photography, and research",
}
---

<BaseLayout
  frontmatter={frontmatter}
  fontPreload={getFontPreload({
    heroSubtitle: true,
    articleContent: true,
    timeInHero: true,
  })}
>
  <Hero>
    <h1>Blog Posts</h1>
    <p>Only a few posts for now, but more content is on the way!</p>
  </Hero>

  <BlogPostList posts={allPosts} />

  <nav>
    <ul>
      <li>
        <a href="/blog/tags">Browse blog tags</a>
      </li>
    </ul>
  </nav>
</BaseLayout>
