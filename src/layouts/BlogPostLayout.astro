---
import BaseLayout from "./BaseLayout.astro"
import Hero from "../components/Hero.astro"

interface Props {
  frontmatter: {
    title: string
    subtitle?: string
    description: string
    pubDate: Date
    lastUpdatedDate?: Date
    tags: string[]
    [key: string]: any
  }
}

const { frontmatter } = Astro.props
const { title, subtitle, pubDate, lastUpdatedDate, tags } = frontmatter

// Format dates
const formatDate = (date: Date) => {
  return new Intl.DateTimeFormat("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  }).format(new Date(date))
}
---

<BaseLayout frontmatter={frontmatter}>
  <Hero>
    <h1>{title}</h1>
    {subtitle && <p>{subtitle}</p>}
    {
      tags && tags.length > 0 && (
        <nav>
          <ul>
            {tags.map((tag: string) => (
              <li>
                <a href={`/tags/${tag}`}>#{tag}</a>
              </li>
            ))}
          </ul>
        </nav>
      )
    }
  </Hero>

  <slot />

  <footer>
    <time datetime={pubDate.toISOString()}>
      Published: {formatDate(pubDate)}
    </time>
    {
      lastUpdatedDate && lastUpdatedDate.getTime() !== pubDate.getTime() && (
        <>
          {" â€¢ "}
          <time datetime={lastUpdatedDate.toISOString()}>
            Updated: {formatDate(lastUpdatedDate)}
          </time>
        </>
      )
    }
  </footer>
</BaseLayout>

<style is:global>
  /* Blog-specific hero styles */

  /* Subtitle color override for blog posts */
  main > header p {
    color: var(--color-on-surface-variant);
    margin-block: 0.5em 1em;
  }

  /* Tags navigation */
  main > header nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    justify-content: center;
  }

  main > header nav a {
    text-decoration: none;
    color: var(--color-accent);
    padding: 0.3em 0.7em;
    border: 1px solid var(--color-accent);
    border-radius: 0.25rem;
    background: var(--color-surface-container);
    transition:
      background-color 0.2s ease,
      color 0.2s ease;
    font-size: 1rem;
  }

  main > header nav a:hover {
    background: var(--color-accent);
    color: var(--color-on-accent);
  }

  /* Article content - natural spacing from existing article styles */
  article {
    margin-block-end: 3em;
  }

  /* Metadata footer */
  article + footer {
    padding-block-start: 1.5em;
    border-block-start: 1px solid var(--color-on-surface-variant);
    font-size: 0.9rem;
    color: var(--color-on-surface-variant);
    text-align: center;
  }

  article + footer time {
    font-style: italic;
  }
</style>
