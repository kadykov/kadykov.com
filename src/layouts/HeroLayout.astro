---
import BaseLayout from "./BaseLayout.astro"

interface Props {
  title: string
  description: string
  pageTitle?: string
}

const { title, description, pageTitle } = Astro.props
const finalPageTitle = pageTitle || `${title} | kadykov.com`
---

<BaseLayout title={finalPageTitle} description={description}>
  <header>
    <h1>{title}</h1>
    <p>{description}</p>
    <slot name="hero-content" />
  </header>
  <slot />
</BaseLayout>

<script>
  // Handle navigation shadow removal when hero is present
  const navigationHeader = document.querySelector(
    "body > header"
  ) as HTMLElement

  if (navigationHeader) {
    // Set initial state - no shadow when hero layout is used
    navigationHeader.style.boxShadow = "none"

    // Listen for natural-sticky state changes
    navigationHeader.addEventListener("natural-sticky", (event) => {
      const customEvent = event as CustomEvent
      const currentState = customEvent.detail.state // 'home', 'sticky', or 'relative'

      // Directly control box-shadow based on state
      if (currentState === "home") {
        navigationHeader.style.boxShadow = "none"
      } else {
        navigationHeader.style.boxShadow = "var(--elevation-2)"
      }
    })
  }
</script>

<style is:global>
  /* Hero header - semantic and classless */
  main > header:first-child {
    background-color: var(--color-surface-container-low);
    min-height: 80vh;
    width: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 2rem;

    /* Add shadow to create seamless extension of navigation */
    box-shadow: var(--elevation-2);

    /* Ensure shadow appears above subsequent content */
    position: relative;
    z-index: 1;
  }

  main > header h1 {
    margin-bottom: 1rem;
    max-width: 30ch;
  }

  main > header p {
    margin: 0;
    max-width: 60ch;
  }

  /* Style content in hero-content slot */
  main > header img {
    border-radius: 50%;
    margin: 1rem auto;
    box-shadow: var(--elevation-1);
  }
</style>
